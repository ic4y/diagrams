<mxfile host="app.diagrams.net" modified="2022-08-17T12:57:02.210Z" agent="5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36" etag="EIzgVPjXuTuWCLuxdOCr" version="20.2.1" type="github">
  <diagram id="zwLIBMyW_0EIfj8ERT4i" name="第 1 页">
    <mxGraphModel dx="3996" dy="1762" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="E99PrjxQKHSVOuY4jozG-7" value="" style="ellipse;shape=cloud;whiteSpace=wrap;html=1;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=20;" vertex="1" parent="1">
          <mxGeometry x="-16" y="250" width="430" height="315" as="geometry" />
        </mxCell>
        <mxCell id="E99PrjxQKHSVOuY4jozG-2" value="&amp;nbsp;Imap&lt;br&gt;&lt;span style=&quot;&quot;&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp; key:JobID&lt;br&gt;&lt;span style=&quot;&quot;&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp; Value:&amp;nbsp;JobState" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=20;align=left;verticalAlign=top;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="100" y="360" width="210" height="110" as="geometry" />
        </mxCell>
        <mxCell id="E99PrjxQKHSVOuY4jozG-5" value="JobState:&lt;br&gt;&lt;span style=&quot;&quot;&gt;	&lt;/span&gt;&lt;span style=&quot;text-align: center;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;	&lt;/span&gt;jobImmutableInformation&lt;br&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;	&lt;/span&gt;JobStatus&lt;br&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;	&lt;/span&gt;PipelineStatus&lt;br&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;	&lt;/span&gt;TaskStatus&lt;br&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=20;align=left;verticalAlign=top;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="470" y="380" width="320" height="140" as="geometry" />
        </mxCell>
        <mxCell id="E99PrjxQKHSVOuY4jozG-6" value="" style="endArrow=classic;html=1;rounded=0;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=16;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;curved=1;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="280" y="420" as="sourcePoint" />
            <mxPoint x="470" y="380" as="targetPoint" />
            <Array as="points">
              <mxPoint x="290" y="370" />
              <mxPoint x="380" y="350" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="E99PrjxQKHSVOuY4jozG-9" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;sketch=1;hachureGap=4;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=16;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" edge="1" parent="1" source="E99PrjxQKHSVOuY4jozG-8">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="590" y="530" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="E99PrjxQKHSVOuY4jozG-10" value="Update" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=20;fontFamily=Architects Daughter;" vertex="1" connectable="0" parent="E99PrjxQKHSVOuY4jozG-9">
          <mxGeometry x="-0.0141" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="E99PrjxQKHSVOuY4jozG-8" value="JobMaster" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=20;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="480" y="690" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="E99PrjxQKHSVOuY4jozG-11" value="&amp;nbsp;SeaTunnelServer&lt;br&gt;&lt;br&gt;&amp;nbsp; &amp;nbsp;getJobStatus(JobId);" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=20;align=left;verticalAlign=top;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="54" y="640" width="290" height="140" as="geometry" />
        </mxCell>
        <mxCell id="E99PrjxQKHSVOuY4jozG-12" value="" style="endArrow=classic;html=1;rounded=0;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=16;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;curved=1;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="270" y="710" as="sourcePoint" />
            <mxPoint x="250" y="440" as="targetPoint" />
            <Array as="points">
              <mxPoint x="364" y="630" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="E99PrjxQKHSVOuY4jozG-13" value="Read" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=20;fontFamily=Architects Daughter;" vertex="1" connectable="0" parent="E99PrjxQKHSVOuY4jozG-12">
          <mxGeometry x="0.1898" y="14" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="E99PrjxQKHSVOuY4jozG-15" value="&lt;h1&gt;&lt;font style=&quot;font-size: 24px;&quot;&gt;集群重启&lt;/font&gt;&lt;/h1&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; 当集群发生重启的时候，会从文件系统恢复Job State到Imap中，这个时候只需要SeatunnelServer从Imap中取出需要恢复执行的Job去恢复执行即可&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=20;" vertex="1" parent="1">
          <mxGeometry x="970" y="270" width="410" height="240" as="geometry" />
        </mxCell>
        <mxCell id="E99PrjxQKHSVOuY4jozG-16" value="Hdfh、S3、LocanFile" style="rounded=1;whiteSpace=wrap;html=1;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=20;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="294" y="90" width="246" height="60" as="geometry" />
        </mxCell>
        <mxCell id="E99PrjxQKHSVOuY4jozG-17" value="" style="endArrow=classic;html=1;rounded=0;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=16;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;curved=1;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="125" y="370" as="sourcePoint" />
            <mxPoint x="285" y="130" as="targetPoint" />
            <Array as="points">
              <mxPoint x="135" y="140" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="E99PrjxQKHSVOuY4jozG-18" value="Presistent" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=20;fontFamily=Architects Daughter;" vertex="1" connectable="0" parent="E99PrjxQKHSVOuY4jozG-17">
          <mxGeometry x="-0.1993" y="-23" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="E99PrjxQKHSVOuY4jozG-19" value="&lt;h1&gt;&lt;font style=&quot;font-size: 24px;&quot;&gt;Master漂移&lt;/font&gt;&lt;/h1&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; 当Master节点发生故障，这个时候集群会选取另一个节点作为Master。这个时候需要在新的节点上恢复JobMaster继续处理任务的状态。部署出去的Task会向新的Master汇报状态。&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=20;" vertex="1" parent="1">
          <mxGeometry x="960" y="20" width="480" height="250" as="geometry" />
        </mxCell>
        <mxCell id="E99PrjxQKHSVOuY4jozG-21" value="&lt;h1&gt;&lt;font style=&quot;font-size: 24px;&quot;&gt;Cluster restart&lt;/font&gt;&lt;/h1&gt;&lt;p&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;&amp;nbsp; &amp;nbsp; When the cluster restarts, the Job State will be restored from the file system to Imap. At this time, SeatunnelServer only needs to take out the Job that needs to be resumed from Imap to resume execution.&lt;/font&gt;&lt;br&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=24;" vertex="1" parent="1">
          <mxGeometry x="54" y="910" width="710" height="280" as="geometry" />
        </mxCell>
        <mxCell id="E99PrjxQKHSVOuY4jozG-22" value="&lt;h1&gt;Master Drift&lt;/h1&gt;&lt;p&gt;When the Master node fails, the cluster will select another node as the Master at this time. At this time, it is necessary to restore the state of the JobMaster to continue processing tasks on the new node. The deployed Task will report the status to the new Master.&lt;br&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;sketch=1;hachureGap=4;fontFamily=Architects Daughter;fontSource=https%3A%2F%2Ffonts.googleapis.com%2Fcss%3Ffamily%3DArchitects%2BDaughter;fontSize=24;" vertex="1" parent="1">
          <mxGeometry x="860" y="900" width="650" height="330" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
